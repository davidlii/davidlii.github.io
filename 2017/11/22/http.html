

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png">
  <link rel="icon" href="/img/avatar.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Davidli">
  <meta name="keywords" content="Davidli">
  
    <meta name="description" content="#1.网络分层 应用层 表示层 会话层 传输层 网络层 数据链路层 物理层  #2.术语2.1.TCP 传输控制协议：传输层协议之一； 面向连接：传输数据前需要三次握手建立连接； 稳定可靠：传输数据时有响应、重发、拥堵控制机制； 时效性低：握手、响应、重发等机制会消耗大量时间，占用大量系统资源。  主要用在需要可靠传输数据的地方，如文件传输协议：HTTP、HTTPS、FTP；邮件传输协议：POP、">
<meta property="og:type" content="article">
<meta property="og:title" content="网络知识点笔记">
<meta property="og:url" content="https://davidlii.cn/2017/11/22/http.html">
<meta property="og:site_name" content="Davidli">
<meta property="og:description" content="#1.网络分层 应用层 表示层 会话层 传输层 网络层 数据链路层 物理层  #2.术语2.1.TCP 传输控制协议：传输层协议之一； 面向连接：传输数据前需要三次握手建立连接； 稳定可靠：传输数据时有响应、重发、拥堵控制机制； 时效性低：握手、响应、重发等机制会消耗大量时间，占用大量系统资源。  主要用在需要可靠传输数据的地方，如文件传输协议：HTTP、HTTPS、FTP；邮件传输协议：POP、">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://davidlii.nos-eastchina1.126.net/pic_tcp_connect.jpeg">
<meta property="og:image" content="https://davidlii.nos-eastchina1.126.net/pic_tcp_disconnect.jpeg">
<meta property="article:published_time" content="2017-11-22T15:13:07.000Z">
<meta property="article:modified_time" content="2019-09-11T14:58:07.000Z">
<meta property="article:author" content="Davidli">
<meta property="article:tag" content="网络">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://davidlii.nos-eastchina1.126.net/pic_tcp_connect.jpeg">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>网络知识点笔记 - Davidli</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"davidlii.cn","root":"/","version":"1.9.2","typing":{"enable":true,"typeSpeed":70,"cursorChar":"","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.2.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Davidlii</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/IMG_0.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="网络知识点笔记"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2017-11-22 23:13" pubdate>
          2017年11月22日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          9.5k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          80 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">网络知识点笔记</h1>
            
            
              <div class="markdown-body">
                
                <h3 id="1-网络分层"><a href="#1-网络分层" class="headerlink" title="#1.网络分层"></a>#1.网络分层</h3><ul>
<li>应用层</li>
<li>表示层</li>
<li>会话层</li>
<li>传输层</li>
<li>网络层</li>
<li>数据链路层</li>
<li>物理层</li>
</ul>
<h3 id="2-术语"><a href="#2-术语" class="headerlink" title="#2.术语"></a>#2.术语</h3><h4 id="2-1-TCP"><a href="#2-1-TCP" class="headerlink" title="2.1.TCP"></a>2.1.TCP</h4><ul>
<li>传输控制协议：传输层协议之一；</li>
<li>面向连接：传输数据前需要三次握手建立连接；</li>
<li>稳定可靠：传输数据时有响应、重发、拥堵控制机制；</li>
<li>时效性低：握手、响应、重发等机制会消耗大量时间，占用大量系统资源。</li>
</ul>
<p>主要用在需要可靠传输数据的地方，如文件传输协议：HTTP、HTTPS、FTP；邮件传输协议：POP、SMTP。</p>
<h4 id="2-2-UDP"><a href="#2-2-UDP" class="headerlink" title="2.2.UDP"></a>2.2.UDP</h4><ul>
<li>用户数据报协议：也是传输层协议之一；</li>
<li>无连接：传输数据前不需事先建立连接，直接向目标主机发送报文；</li>
<li>不可靠：不保证数据能收到或完整收到，只做报文完整性校验，不完整则丢弃；</li>
<li>速度快：没有TCP那么复杂的机制，简单高效速度快；</li>
</ul>
<p>主要用在追求通信速度但对通信质量要求不高的地方，如语音视频、游戏画面和语音。</p>
<h4 id="2-3-HTTP"><a href="#2-3-HTTP" class="headerlink" title="2.3.HTTP"></a>2.3.HTTP</h4><p>超文本传输协议，属于应用层协议，基于<code>TCP</code>协议和<code>请求/响应</code>模型，用于在web服务器与客户端浏览器之间封装和传输数据。客户端发送请求后需要服务器响应，请求结束后会主动释放连接，因此它属于短连接。</p>
<h4 id="2-4-SOCKET"><a href="#2-4-SOCKET" class="headerlink" title="2.4.SOCKET"></a>2.4.SOCKET</h4><p><code>SOCKET</code>位于<code>应用层</code>和<code>传输层</code>之间，不是协议而是对TCP&#x2F;IP协议的抽象与封装，隐藏了TCP与IP的所有细节，并对外提供接口以供 HTTP 开发者方便地使用TCP&#x2F;IP协议。</p>
<p>SOCKET 通信需要两个端：客户端和服务端。</p>
<ul>
<li>服务端：监听网络状态，等待来自客户端的连接；</li>
<li>客户端：指定 ip 与端口，向服务器请求连接；</li>
<li>服务器：响应客户端的连接请求，建立一个新线程，把服务端套接字的描述发给客户端，客户端确认此描述后双方正式建立连接。</li>
</ul>
<p>理论上 SOCKET 是一种长连接，即客户端与服务端的连接建立之后，一般不会主动断掉。如果长时间没有通信则防火墙可能会断开此连接以释放资源，所以一般 SOCKET 在没有数据传输时需要发送心跳包以保持连接。</p>
<h4 id="2-5-IP协议"><a href="#2-5-IP协议" class="headerlink" title="2.5.IP协议"></a>2.5.IP协议</h4><p>网络层协议，解决网络路由和寻址问题。</p>
<h4 id="2-6-TCP-x2F-IP"><a href="#2-6-TCP-x2F-IP" class="headerlink" title="2.6.TCP&#x2F;IP"></a>2.6.TCP&#x2F;IP</h4><p>传输控制协议&#x2F;网际协议，指的是一系列协议。</p>
<h3 id="3-三次握手"><a href="#3-三次握手" class="headerlink" title="#3.三次握手"></a>#3.三次握手</h3><p>TCP请求在发送数据之前，会先进行三次握手，以正式建立连接：</p>
<p><img src="https://davidlii.nos-eastchina1.126.net/pic_tcp_connect.jpeg" srcset="/img/loading.gif" lazyload alt="握手"></p>
<p><strong>第1次</strong>：<code>主机A</code> 发送<code>SYN包</code>到 <code>主机B</code>，并进入<code>SYN_SEND</code>状态，等待 <code>主机B</code> 确认；</p>
<p><strong>第2次</strong>：<code>主机B</code> 收到<code>SYN包</code>，必须确认 <code>主机A</code> 的<code>SYN</code>，同时自己也发送一个<code>SYN包</code>，即<code>SYN+ACK包</code>，此时 <code>主机B</code> 进入<code>SYN_RECV状态</code>；</p>
<p><strong>第3次</strong>：<code>主机A</code> 收到 <code>主机B</code> 的<code>SYN＋ACK</code>包，向 <code>主机B</code> 发送确认包<code>ACK</code>；</p>
<p>第三个包发送完毕后 <code>主机A</code> 和 <code>主机B</code> 进入<code>ESTABLISHED</code>状态，完成三次握手。</p>
<h3 id="4-四次挥手"><a href="#4-四次挥手" class="headerlink" title="#4.四次挥手"></a>#4.四次挥手</h3><p>TCP连接在断开时需要四个步骤：</p>
<p><img src="https://davidlii.nos-eastchina1.126.net/pic_tcp_disconnect.jpeg" srcset="/img/loading.gif" lazyload alt="挥手"></p>
<p><strong>第1次</strong>：<code>主机A</code> 发送完数据且知道 <code>主机B</code> 已接收完，想要关闭发送数据口，发 <code>FIN</code> 给 <code>主机B</code>；</p>
<p><strong>第2次</strong>：<code>主机B</code> 收到 <code>主机A</code> 发送的<code>FIN</code>，表示收到了，就会发送 <code>ACK</code> 回复；</p>
<p><strong>第3次</strong>：这时 <code>主机B</code> 可能还在发送数据，不想关闭数据口，在发完<code>ACK</code>后继续把数据发送完了再发送<code>FIN</code>给 <code>主机A</code>。</p>
<p><strong>第4次</strong>：<code>主机A</code> 收到 <code>主机B</code> 发来的<code>FIN</code>，知道 <code>主机B</code> 的数据也发送完了，回复ACK。<code>主机A</code> 等待 2MSL（2倍报文最长存活时间）后没有收到 <code>主机B</code> 传来的任何消息，知道 <code>主机B</code> 已经收到自己的ACK了，<code>主机A</code> 就关闭连接，<code>主机B</code> 也关闭连接。</p>
<p><strong>问：A为什么等待2MSL?</strong> </p>
<p>在<code>A</code>发送出最后的 ACK 回复后，该 ACK 可能丢失。<code>B</code>如果没有收到 ACK，将不断重发 FIN。所以<code>A</code>不能立即关闭，必须确认<code>B</code>收到了该 ACK。<code>A</code>会在发送出 ACK 后进入<code>TIME_WAIT</code>状态并设置一个计时器，等待 2MSL 的时间。如果在该时间内再次收到 FIN，那么<code>A</code>会重发 ACK 并再次等待 2MSL。如果直到 2MSL<code>A</code>都没有再次收到 FIN，那么<code>A</code>推断 <code>B</code>已经成功接收自己的 ACK，则结束 TCP 连接。</p>
<h3 id="5-无状态"><a href="#5-无状态" class="headerlink" title="#5.无状态"></a>#5.无状态</h3><p>HTTP协议是无状态的，指的是协议对于事务处理没有记忆能力，服务器不知道客户端是什么状态。也就是说，打开一个服务器上的网页和你之前打开这个服务器上的网页之间没有任何联系。</p>
<h3 id="6-短-x2F-长连接"><a href="#6-短-x2F-长连接" class="headerlink" title="#6.短&#x2F;长连接"></a>#6.短&#x2F;长连接</h3><p>HTTP 是应用层协议，基于 TCP 这一传输层协议。TCP 连接在 IP层上安全、面向连接地传递数据包。在HTTP&#x2F;1.0中，HTTP 默认使用的是短连接。浏览器和服务器每进行一次HTTP操作，就建立一次连接，任务结束就中断连接。如果客户端浏览器访问的某个HTML页面中包含有其他的Web资源，如Js、图像、CSS文件等，那么浏览器每遇到一个Web资源就会建立一次会话。从 HTTP&#x2F;1.1 起，浏览器开始默认使用长连接，用以保持连接特性。使用长连接时会在响应头加入这行代码：</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">Connection:</span><span class="hljs-meta">keep</span>-alive<br></code></pre></td></tr></table></figure>

<p>使用长连接时，当一个网页打开完成后，客户端和服务器之间的 TCP 连接不会关闭，如果客户端再次访问这个服务器上的网页，会继续使用已经建立的连接。Keep-Alive 不会永久保持连接，它有一个保持时间，可以在不同的服务器软件（如Apache）中设定这个时间。实现长连接要客户端和服务端都支持长连接，现在各个浏览器的高版本基本都是支持长连接。</p>
<h4 id="优点和缺点"><a href="#优点和缺点" class="headerlink" title="优点和缺点"></a>优点和缺点</h4><p>短连接：对于服务器来说管理较为简单，存在的连接都是有用的连接，不需要额外的控制手段。但如果客户请求频繁，将在TCP的建立和关闭操作上浪费时间和带宽。</p>
<p>长连接：可以省去较多的TCP建立和关闭的操作，减少浪费，节约时间。对于频繁请求资源的客户来说，较适用长连接。但连接一直不关闭的话，会存在一个问题，随着客户端连接越来越多，服务端可能会扛不住。</p>
<h4 id="数据发送完成？"><a href="#数据发送完成？" class="headerlink" title="数据发送完成？"></a>数据发送完成？</h4><p>短连接模式下，服务器通常在发送回所请求的数据之后就关闭连接。这样客户端读数据时会返回<code>EOF(-1)</code>，就知道数据已经接收完全了。但是长连接模式发送完数据后服务器不会自动断开连接，所以不能再使用返回<code>EOF(-1)</code>来判断。</p>
<ul>
<li><strong>Conent-Length</strong></li>
</ul>
<p>客户端向服务器请求一个资源时，服务器可以很清楚的知道内容大小，它通过消息首部中的<code>Content-length</code>字段告诉客户端总共需要接收多少数据，客户端可以根据这个值和已接收的值来判断数据是否接收完成。</p>
<ul>
<li><strong>Transfer-Encoding</strong></li>
</ul>
<p>对于边产生数据边发给客户端的动态页面，服务器需使用<code>Transfer-Encoding:chunked</code>的方式来代替<code>Content-Length</code>。</p>
<p>chunk编码将数据分成一块一块的发送，以一个标明长度为0的chunk标示结束。每个chunk分为头部和正文两部分，头部内容指定正文的字符总数和数量单位，正文部分就是指定长度的实际内容，两部分之间用回车换行(CRLF)隔开。在最后一个长度为0的Chunk中的内容是称为footer的内容，是一些附加的Header信息（通常可以直接忽略）。</p>
<p>Chunk编码的格式如下：</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Chunked-Body = *chunk<br><span class="hljs-string">&quot;0&quot;</span> <span class="hljs-literal">CRLF</span><br>footer<br><span class="hljs-literal">CRLF</span><br>chunk = chunk-size [ chunk-ext ] <span class="hljs-literal">CRLF</span><br>chunk-data <span class="hljs-literal">CRLF</span><br><br>hex-no-<span class="hljs-literal">zero</span> = &lt;HEX excluding <span class="hljs-string">&quot;0&quot;</span>&gt;<br><br>chunk-size = hex-no-<span class="hljs-literal">zero</span> *HEX<br>chunk-ext = *( <span class="hljs-string">&quot;;&quot;</span> chunk-ext-name [ <span class="hljs-string">&quot;=&quot;</span> chunk-ext-<span class="hljs-built_in">value</span> ] )<br>chunk-ext-name = <span class="hljs-keyword">token</span><br>chunk-ext-val = <span class="hljs-keyword">token</span> | quoted-<span class="hljs-keyword">string</span><br>chunk-data = chunk-size(OCTET)<br><br>footer = *entity-header<br></code></pre></td></tr></table></figure>

<p>消息长度的总结：</p>
<ol>
<li>为了兼容HTTP&#x2F;1.0应用程序，HTTP&#x2F;1.1的请求消息体中须包含<code>Content-Length</code>字段；</li>
<li><code>content-length</code>字段对应的值须和消息体里面的长度完全匹配；</li>
<li>同时存在<code>Transfer-Encoding</code>和<code>Content-Length</code>字段，忽略<code>Content-Length</code>字段；</li>
<li>如果采用短连接，则可以直接通过服务器关闭连接来确定消息的传输长度。</li>
</ol>
<h3 id="7-HTTP头部"><a href="#7-HTTP头部" class="headerlink" title="#7.HTTP头部"></a>#7.HTTP头部</h3><p>HTTP协议采用了<code>请求/响应模型</code>。客户端向服务器发送一个请求，请求头包含：请求的方法、URI、协议版本、以及包含请求修饰符、客户信息和内容的类似于MIME的消息结构。服务器以一个状态行作为响应，响应的内容包括：消息协议的版本，成功或者错误编码加上包含服务器信息、实体元信息以及可能的实体内容。</p>
<p>通常HTTP消息包括客户端向服务器的请求消息和服务器向客户端的响应消息。这两种类型的消息由一个起始行，一个或者多个头域，一个只是头域结束的空行和可选的消息体组成。HTTP的头域包括通用头，请求头，响应头和实体头四个部分。每个头域由一个域名，冒号（:）和域值三部分组成。域名是大小写无关的，域值前可以添加任何数量的空格符，头域可以被扩展为多行，在每行开始处，使用至少一个空格或制表符。</p>
<h4 id="请求消息头"><a href="#请求消息头" class="headerlink" title="请求消息头"></a>请求消息头</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Host</span>：rss.sina.com.cn<br><span class="hljs-attribute">User</span>-Agent：Mozilla/<span class="hljs-number">5</span>、<span class="hljs-number">0</span> (Windows; U; Windows NT <span class="hljs-number">5</span>、<span class="hljs-number">1</span>; zh-CN; <br><span class="hljs-attribute">rv</span>:<span class="hljs-number">1</span>、<span class="hljs-number">8</span>、<span class="hljs-number">1</span>、<span class="hljs-number">14</span>) Gecko/<span class="hljs-number">20080404</span> Firefox/<span class="hljs-number">2</span>、<span class="hljs-number">0</span>、<span class="hljs-number">0</span>、<span class="hljs-number">14</span><br><span class="hljs-attribute">Accept</span>：text/xml,application/xml,application/xhtml+xml,text/html;<br><span class="hljs-attribute">q</span>=<span class="hljs-number">0</span>、<span class="hljs-number">9</span>,text/plain;q=<span class="hljs-number">0</span>、<span class="hljs-number">8</span>,image/png,*/*;q=<span class="hljs-number">0</span>、<span class="hljs-number">5</span><br><span class="hljs-attribute">Accept</span>-Language：zh-cn,zh;q=<span class="hljs-number">0</span>、<span class="hljs-number">5</span><br><span class="hljs-attribute">Accept</span>-Encoding：gzip,deflate<br><span class="hljs-attribute">Accept</span>-Charset：gb2312,utf-<span class="hljs-number">8</span>;q=<span class="hljs-number">0</span>、<span class="hljs-number">7</span>,*;q=<span class="hljs-number">0</span>、<span class="hljs-number">7</span><br><span class="hljs-attribute">Keep</span>-Alive：<span class="hljs-number">300</span><br><span class="hljs-attribute">Connection</span>：keep-alive<br><span class="hljs-attribute">Cookie</span>：userId=C5bYpXrimdmsiQmsBPnE1Vn8ZQmdWSm3WRlEB3vRwTnRtW &amp;lt;-- Cookie<br><span class="hljs-attribute">If</span>-Modified-Since：Sun, <span class="hljs-number">01</span> Jun <span class="hljs-number">2008</span> <span class="hljs-number">12</span>:<span class="hljs-number">05</span>:<span class="hljs-number">30</span> GMT<br><span class="hljs-attribute">Cache</span>-Control：max-age=<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure>

<h4 id="响应消息头"><a href="#响应消息头" class="headerlink" title="响应消息头"></a>响应消息头</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Status：OK - <span class="hljs-number">200</span> &amp;lt;<span class="hljs-comment">-- 响应状态码，表示 web 服务器处理的结果。</span><br><span class="hljs-type">Date</span>：Sun, <span class="hljs-number">01</span> Jun <span class="hljs-number">2008</span> <span class="hljs-number">12</span>:<span class="hljs-number">35</span>:<span class="hljs-number">47</span> GMT<br><span class="hljs-keyword">Server</span>：Apache/<span class="hljs-number">2</span>、<span class="hljs-number">0</span>、<span class="hljs-number">61</span> (Unix)<br>Last-Modified：Sun, <span class="hljs-number">01</span> Jun <span class="hljs-number">2008</span> <span class="hljs-number">12</span>:<span class="hljs-number">35</span>:<span class="hljs-number">30</span> GMT<br>Accept-Ranges：bytes<br>Content-Length：<span class="hljs-number">18616</span><br><span class="hljs-keyword">Cache</span>-Control：max-age=<span class="hljs-number">120</span><br>Expires：Sun, <span class="hljs-number">01</span> Jun <span class="hljs-number">2008</span> <span class="hljs-number">12</span>:<span class="hljs-number">37</span>:<span class="hljs-number">47</span> GMT<br>Content-<span class="hljs-keyword">Type</span>：application/<span class="hljs-type">xml</span><br>Age：<span class="hljs-number">2</span><br>X-<span class="hljs-keyword">Cache</span>：HIT from <span class="hljs-number">236</span><span class="hljs-number">-41</span>、D07071951、sina、com、cn &amp;lt;<br><span class="hljs-comment">-- 反向代理服务器使用的 HTTP 头部</span><br>Via：<span class="hljs-number">1.0</span> <span class="hljs-number">236</span><span class="hljs-number">-41.</span>D07071951.sina.com.cn:<span class="hljs-number">80</span> (squid/<span class="hljs-number">2.6</span>.STABLE13)<br><span class="hljs-keyword">Connection</span>：<span class="hljs-keyword">close</span><br></code></pre></td></tr></table></figure>

<h4 id="Content-Type"><a href="#Content-Type" class="headerlink" title="Content-Type"></a>Content-Type</h4><p>用于指定请求和响应的HTTP内容的类型。如果未指定默认为text&#x2F;html。</p>
<figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">类型格式：<span class="hljs-keyword">type</span>/<span class="hljs-keyword">subtype</span>(;<span class="hljs-keyword">parameter</span>)? <span class="hljs-keyword">type</span><br><span class="hljs-keyword">type</span>，主类型，任意的字符串，如<span class="hljs-literal">text</span>，*代表所有；<br><span class="hljs-keyword">subtype</span>，子类型，任意的字符串，如html，*代表所有；<br><span class="hljs-keyword">parameter</span>，可选，一些参数，如Accept请求头的q参数， Content-<span class="hljs-keyword">Type</span>的 charset参数。<br></code></pre></td></tr></table></figure>

<p>常见的媒体格式类型如下：</p>
<ul>
<li>text&#x2F;html ： HTML格式</li>
<li>text&#x2F;plain ：纯文本格式</li>
<li>text&#x2F;xml ：  XML格式</li>
<li>image&#x2F;gif ：gif图片格式</li>
<li>image&#x2F;jpeg ：jpg图片格式</li>
<li>image&#x2F;png：png图片格式</li>
</ul>
<p>以application开头的媒体格式类型：</p>
<ul>
<li>application&#x2F;xhtml+xml ：XHTML格式</li>
<li>application&#x2F;xml     ： XML数据格式</li>
<li>application&#x2F;atom+xml  ：Atom XML聚合格式</li>
<li>application&#x2F;json    ： JSON数据格式</li>
<li>application&#x2F;pdf       ：pdf格式</li>
<li>application&#x2F;msword  ： Word文档格式</li>
<li>application&#x2F;<font color=#0000FF><strong>x-www-form-urlencoded</strong></font> ：表单默认的提交数据的格式（表单键值对）</li>
<li>application&#x2F;<font color=#0000FF><strong>octet-stream</strong></font> ：上传二进制数据（只能提交一个文件）</li>
<li><font color=#0000FF><strong>multipart&#x2F;form-data</strong></font> ：既可以上传表单键值对，也可以上传二进制数据（可传多个文件）</li>
</ul>
<h3 id="8-GET-与-POST"><a href="#8-GET-与-POST" class="headerlink" title="#8.GET 与 POST"></a>#8.GET 与 POST</h3><p>Http定义了与服务器交互的不同方法，最基本的方法有4种：</p>
<ul>
<li>GET：查询资源的信息；</li>
<li>POST：向服务器提交数据，通常是以表单的形式；</li>
<li>PUT：向服务器写入文档；</li>
<li>DELETE：删除资源。</li>
</ul>
<p>最常用的是 GET 和 POST：</p>
<h4 id="用途："><a href="#用途：" class="headerlink" title="用途："></a>用途：</h4><ul>
<li>GET一般用于查询资源信息，POST一般用于提交数据、更新资源信息。</li>
</ul>
<h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><ul>
<li>GET 请求的数据会附在 URL 之后，以?分割 URL 和传输数据；</li>
<li>POST 请求的数据被放在 HTTP 包的 body 中；</li>
<li>GET 比 POST 更不安全，因为参数直接暴露在 URL 上，不能用来传递敏感信息；</li>
<li>GET 请求的URL可以设置成书签，POST不可以；</li>
<li>GET 请求的参数会被完整的保留在浏览历史记录中，POST 请求不会；</li>
<li>GET 请求 URL 中的参数有长度限制，POST 没有；</li>
</ul>
<h4 id="数据包"><a href="#数据包" class="headerlink" title="数据包"></a>数据包</h4><ul>
<li>GET 请求只产生一个 TCP 数据包，浏览器会把 Header 和 data 一并发送出去，服务器响应200；</li>
<li>POST 请求产生两个 TCP 数据包，浏览器先发送 Header，服务器响应 100 continue；浏览器再发送data，服务器响应 200。</li>
</ul>
<p><strong>注：</strong> 从本质上来说，GET 与 POST 都是 Http 协议中发送请求的方法，底层都是基于 TCP 的链接。技术上来讲如果你想，你可以给 GET 请求加上 request body，也可以给 POST 请求的URL加上参数。但一般我们不会这样做，因为上面所说的这些都是 Http 协议已经约定俗成的规则。</p>
<h3 id="9-Http-与-Https"><a href="#9-Http-与-Https" class="headerlink" title="#9.Http 与 Https"></a>#9.Http 与 Https</h3><p>Http的缺点：</p>
<ul>
<li>通信不加密，使用明文，内容可能会被窃听；</li>
<li>不验证通信方的身份，有可能遭遇伪装；</li>
<li>无法证明报文的完整性，所以有可能已遭篡改；</li>
</ul>
<p>Http的优点：</p>
<ul>
<li>传输速度快</li>
</ul>
<p><code>Https</code>并非是应用层的一种新协议，它只是<code>Http</code>通信接口部分用<code>SSL</code>或<code>TLS</code>代替而已，即添加了加密及认证机制。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">Https</span> = Http + 加密 + 认证 + 完整性保护<br></code></pre></td></tr></table></figure>

<h4 id="SSL"><a href="#SSL" class="headerlink" title="SSL"></a>SSL</h4><p>全称 Secure Socket Layer，即安全套接层，是网景公司开发的一种安全协议，用以为网络通信提供<code>安全</code>及<code>数据完整性</code>。当前版本为3.0，被广泛地用于Web浏览器与服务器之间的<code>身份认证</code>和<code>加密数据传输</code>。SSL 协议位于 TCP&#x2F;IP 协议与各种应用层协议之间，为数据通讯提供安全支持。</p>
<h4 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h4><p>全称 Transport Layer Security，即安全传输层协议，是 SSL 的继任者，它是 IETF 将 SSL 进行标准化的成果。从技术上讲，TLS 1.0与 SSL 3.0的差异非常微小，具体内容可参考 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/TLS/2979545?fr=aladdin">这里</a>~</p>
<h4 id="密钥加密"><a href="#密钥加密" class="headerlink" title="密钥加密"></a>密钥加密</h4><p>密钥加密使用一对非对称的密钥：私钥和公钥。私钥不能让其他任何人知道，而公钥则可以随意发布，任何人都可以获得。使用公钥加密方式时，发送密文的一方使用对方的公钥进行加密处理，对方收到被加密的信息后，再使用自己的私钥进行解密。这种方式相对比较安全，因为不需要发送用来解密的私钥，也不必担心密钥被攻击者窃听而盗走。</p>
<h4 id="Https请求流程"><a href="#Https请求流程" class="headerlink" title="Https请求流程"></a>Https请求流程</h4><ol>
<li>DNS Lookup；</li>
<li>TCP Handshake；</li>
<li>TLS或SSL Handshake；</li>
<li>TCP&#x2F;HTTP Request&#x2F;Response；</li>
</ol>
<p>Https 在传输数据之前需要客户端（浏览器）与服务端（网站）之间进行 SSL 握手，握手过程中将确立双方加密传输数据的密码信息，过程描述如下：</p>
<p>1.浏览器将自己支持的一套加密规则发送给服务端。</p>
<p>2.服务端从中选出一组加密算法，并将自己的身份信息以证书的形式发回给浏览器。证书里面包含了网站地址、加密公钥、证书颁发机构等信息。</p>
<p>3.获得服务端证书之后浏览器要做以下工作：</p>
<ul>
<li>验证证书的合法性（证书的颁发机构是否合法，网站地址是否与正在访问的地址一致等），如果证书受信任，则浏览器栏里面会显示一个小锁头，否则会给出证书不受信的提示；</li>
<li>如果证书受信任，或者是用户接受了不受信的证书，浏览器会生成一串随机数的密码，并用证书中提供的公钥加密；</li>
<li>使用约定好的HASH计算握手消息，并使用生成的随机数对消息进行加密，最后将之前生成的所有信息发送给服务端；</li>
</ul>
<p>4.服务端接收浏览器发来的数据之后要做以下的操作：</p>
<ul>
<li>使用自己的私钥将信息解密取出密码，使用密码解密浏览器发来的握手消息，并验证HASH是否与浏览器发来的一致；</li>
<li>使用密码加密一段握手消息，发送给浏览器；</li>
</ul>
<p>5.浏览器解密并计算握手消息的HASH，如果与服务端发来的HASH一致，此时握手过程结束，之后所有的通信数据将由之前浏览器生成的随机密码并利用对称加密算法进行加密。</p>
<h3 id="10-网络优化"><a href="#10-网络优化" class="headerlink" title="#10.网络优化"></a>#10.网络优化</h3><h4 id="10-1-网络检测"><a href="#10-1-网络检测" class="headerlink" title="10.1.网络检测"></a>10.1.网络检测</h4><p>检测用户所处的网络环境，2G&#x2F;3G&#x2F;4G&#x2F;Wi-Fi以及当前网速，动态应对：</p>
<ol>
<li>动态调整网络请求的并发数</li>
</ol>
<p>网络差时将任务的并发数置为更小值，或者串行；注意并发数不宜过大或者过小，并发数过大在网络差时会造成更大的拥堵和整体延时；并发数过小在网络差时会造成急切请求等普通请求的情况。</p>
<p>控制并发数可以从两个层面入手，一个是在发起时控制请求的执行数量；一个是设置网络连接本身的最大并发数；</p>
<ul>
<li>控制任务请求的并发数</li>
</ul>
<p>基于信号量、NSOperation或者GCD，控制任务的并发数量，比如AFN早期版本中的<code>AFHTTPRequestOperation</code>；</p>
<ul>
<li>HTTPMaximumConnectionsPerHost</li>
</ul>
<blockquote>
<p>The maximum number of simultaneous connections to make to a given host.</p>
</blockquote>
<p>This property determines the maximum number of simultaneous connections made to each host by tasks within sessions based on this configuration. This limit is per session, so if you use multiple sessions, your app as a whole may exceed this limit. Additionally, depending on your connection to the Internet, a session may use a lower limit than the one you specify. The default value is 6 in macOS, or 4 in iOS.</p>
<p>这是NSURLSessionConfiguration的一个属性，表示同一个服务器同时接受的最大连接并发数，默认情况下iOS支持最多4个并发；每个session对应着一个设置，如果配置N个session则主机同时可接受的最大并发数可能会超过你给单个session设置的限制。</p>
<ol start="2">
<li>动态设置超时时间</li>
</ol>
<p>网络差时，将请求的超时时间置为更短，节省后面请求的等待时间；</p>
<ol start="3">
<li>减少数据传输量</li>
</ol>
<p>将待传输的数据进行分割，分批或者压缩再传输；同时配合<code>AFN</code>库中提供的 throttle 方法:</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs applescript">/**<br> Throttles request bandwidth <span class="hljs-keyword">by</span> limiting <span class="hljs-keyword">the</span> packet size <br> <span class="hljs-keyword">and</span> adding a <span class="hljs-built_in">delay</span> <span class="hljs-keyword">for</span> each chunk <span class="hljs-built_in">read</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">the</span> upload stream.<br><br> When uploading <span class="hljs-keyword">over</span> a <span class="hljs-number">3</span>G <span class="hljs-keyword">or</span> EDGE connection, requests may fail <span class="hljs-keyword">with</span> <span class="hljs-string">&quot;request body stream exhausted&quot;</span>. <br> Setting a maximum packet size <span class="hljs-keyword">and</span> <span class="hljs-built_in">delay</span> according <span class="hljs-keyword">to</span> <span class="hljs-keyword">the</span> recommended values (`kAFUploadStream3GSuggestedPacketSize` <br> <span class="hljs-keyword">and</span> `kAFUploadStream3GSuggestedDelay`) lowers <span class="hljs-keyword">the</span> risk <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> input stream exceeding <span class="hljs-keyword">its</span> allocated bandwidth. <br> Unfortunately, there <span class="hljs-keyword">is</span> no definite way <span class="hljs-keyword">to</span> distinguish <span class="hljs-keyword">between</span> a <span class="hljs-number">3</span>G, EDGE, <span class="hljs-keyword">or</span> LTE connection <span class="hljs-keyword">over</span> `NSURLConnection`. <br> As such, <span class="hljs-keyword">it</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> recommended <span class="hljs-keyword">that</span> you throttle bandwidth based solely <span class="hljs-keyword">on</span> network reachability. <br> Instead, you should consider checking <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> <span class="hljs-string">&quot;request body stream exhausted&quot;</span> <span class="hljs-keyword">in</span> a failure block, <br> <span class="hljs-keyword">and</span> <span class="hljs-keyword">then</span> retrying <span class="hljs-keyword">the</span> request <span class="hljs-keyword">with</span> throttled bandwidth.<br><br> @param numberOfBytes Maximum packet size, <span class="hljs-keyword">in</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> bytes. The default packet size <span class="hljs-keyword">for</span> an input stream <span class="hljs-keyword">is</span> <span class="hljs-number">16</span>kb.<br> @param <span class="hljs-built_in">delay</span> Duration <span class="hljs-keyword">of</span> <span class="hljs-built_in">delay</span> each <span class="hljs-built_in">time</span> a packet <span class="hljs-keyword">is</span> <span class="hljs-built_in">read</span>. By default, no <span class="hljs-built_in">delay</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">set</span>.<br> */<br>- (void)throttleBandwidthWithPacketSize:(NSUInteger)numberOfBytes<br>                                  <span class="hljs-built_in">delay</span>:(NSTimeInterval)<span class="hljs-built_in">delay</span>;<br></code></pre></td></tr></table></figure>

<ol start="4">
<li>提供重发机制</li>
</ol>
<p>遭遇请求失败或超时等错误时，可自动尝试指定次数的重发。</p>
<ol start="5">
<li>使用HTTP缓存</li>
</ol>
<p>结合实际情况，合理设置<code>NSURLRequestCachePolicy</code>缓存策略。</p>
<h4 id="10-2-DNS解析"><a href="#10-2-DNS解析" class="headerlink" title="10.2.DNS解析"></a>10.2.DNS解析</h4><p>应用内置服务器的IP列表，该列表可以在应用启动服务中下发更新。</p>
<h4 id="10-3-HTTP版本"><a href="#10-3-HTTP版本" class="headerlink" title="10.3.HTTP版本"></a>10.3.HTTP版本</h4><p>使用HTTP1.1及以上版本，自动开启<code>Connection: Keep-Alive</code>，省去TCP频繁三次握手的时间；</p>
<p>最近看到一篇 <a target="_blank" rel="noopener" href="http://www.php230.com/weixin1457310207.html">文章</a>，里面讲到了 HTTP 2.0，而且 iOS 9 开始已经支持 HTTP 2.0，只是目前主流的还是 HTTP 1.1；另外，最近在 Github 上看到微信有一个网络基础组件开源库 <a target="_blank" rel="noopener" href="https://github.com/Tencent/mars">Mars</a>，这两个点后面抽时间再继续研究一下~</p>
<hr>
<p>相关参考：</p>
<p>#<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Yfling/p/6670495.html">©Yfling-HTTPS加密原理</a></p>
<p>#<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/1d468ec8162f">©软件iOS开发-iOS网络层详解和优化</a></p>
<p>#<a target="_blank" rel="noopener" href="http://www.php230.com/weixin1457310207.html">©偷师饿了么:怎样用HTTP&#x2F;2优化iOS APP网络层次架构</a></p>
<p>#<a target="_blank" rel="noopener" href="https://www.cnblogs.com/huhuuu/p/3572485.html">©网络TCP建立连接为什么需要三次握手而结束要四次</a></p>
<p>#<a target="_blank" rel="noopener" href="http://www.techweb.com.cn/network/system/2016-10-11/2407736.shtml">©51cto-GET与POST的区别</a></p>
<p>#<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41648325/article/details/79412158">©Socket和Http之间的区别和概述</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E6%8A%80%E6%9C%AF/" class="category-chain-item">技术</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E7%BD%91%E7%BB%9C/">#网络</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>网络知识点笔记</div>
      <div>https://davidlii.cn/2017/11/22/http.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Davidli</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2017年11月22日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2017/11/23/js-native.html" title="js-Native交互">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">js-Native交互</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2017/11/21/lock.html" title="iOS中的八大锁">
                        <span class="hidden-mobile">iOS中的八大锁</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://github.com/davidli-" target="_blank" rel="nofollow noopener"><span>Davidlii</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
